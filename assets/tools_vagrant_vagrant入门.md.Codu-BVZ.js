import{_ as s,c as a,o as i,a3 as n}from"./chunks/framework.C6cJSjK0.js";const F=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"tools/vagrant/vagrant入门.md","filePath":"tools/vagrant/vagrant入门.md"}'),t={name:"tools/vagrant/vagrant入门.md"},e=n(`<h2 id="一、安装vagrant" tabindex="-1">一、安装vagrant <a class="header-anchor" href="#一、安装vagrant" aria-label="Permalink to &quot;一、安装vagrant&quot;">​</a></h2><p>1.安装vagrant 下载地址：<a href="https://www.vagrantup.com/downloads" target="_blank" rel="noreferrer">https://www.vagrantup.com/downloads</a></p><p>2.安装额外工具</p><p>如果要创建Vmware虚拟机，还要额外安装vagrant、vagrant-vmware-utility</p><ul><li>vagrant-vmware-utility工具。下载地址：<a href="https://www.vagrantup.com/downloads" target="_blank" rel="noreferrer">https://www.vagrantup.com/downloads</a></li><li>vagrant-vmware-desktop插件</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> plugin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vagrant-vmware-desktop</span></span></code></pre></div><h2 id="二、使用vagrant创建虚拟机" tabindex="-1">二、使用vagrant创建虚拟机 <a class="header-anchor" href="#二、使用vagrant创建虚拟机" aria-label="Permalink to &quot;二、使用vagrant创建虚拟机&quot;">​</a></h2><h3 id="命令方式" tabindex="-1">命令方式 <a class="header-anchor" href="#命令方式" aria-label="Permalink to &quot;命令方式&quot;">​</a></h3><p>只需要两条命令，即可创建默认配置的虚拟机。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generic/centos7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#创建vmware</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --provider=vmware_desktop</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#也可以用来搭建docker统一开发环境。实际上会直接基于Dockerfile来创建</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#【既然是统一开发环境，还是用vagrant(windows上使用docker有点小麻烦)。生产环境用docker】</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --provider=docker</span></span></code></pre></div><h3 id="vagrantfile方式" tabindex="-1">vagrantfile方式 <a class="header-anchor" href="#vagrantfile方式" aria-label="Permalink to &quot;vagrantfile方式&quot;">​</a></h3><p>通常，我们需要对虚拟机进行自定义配置，只需要指定vagrantfile配置文件。vagrantfile配置项可以参考：<a href="https://www.vagrantup.com/docs/vagrantfile" target="_blank" rel="noreferrer">vagrantfile</a></p><p>在vagrantfile文件同目录下执行以下命令</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#(默认)创建vb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#创建vmware</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --provider=vmware_desktop</span></span></code></pre></div><h3 id="添加box" tabindex="-1">添加box <a class="header-anchor" href="#添加box" aria-label="Permalink to &quot;添加box&quot;">​</a></h3><p>创建虚拟机时，会联网拉取box。可以事先下载好box并安装到本地，节省拉取box的时间。下面是步骤：</p><p>1.下载centos7镜像：</p><p>centos/7：</p><p><a href="https://app.vagrantup.com/centos/boxes/7" target="_blank" rel="noreferrer">https://app.vagrantup.com/centos/boxes/7</a></p><p><a href="http://mirrors.ustc.edu.cn/centos-cloud/centos/7/vagrant/x86_64/images/" target="_blank" rel="noreferrer">http://mirrors.ustc.edu.cn/centos-cloud/centos/7/vagrant/x86_64/images/</a></p><p>generic/centos7：</p><p><a href="https://app.vagrantup.com/generic/boxes/centos7" target="_blank" rel="noreferrer">https://app.vagrantup.com/generic/boxes/centos7</a></p><p>2.将镜像加入到本地仓库 这是我加入的两个centos7镜像，一个是virtualbox环境，一个vmware环境。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#注意：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#①请使用英文目录</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#②可以使用相同的box名，只要provider不同即可。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> centos/7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./CentOS-7-x86_64-Vagrant-2004_01.VirtualBox.box</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> centos/7</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./CentOS-7-x86_64-Vagrant-2004_01.VMwareFusion.box</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#查看一下镜像列表：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span></code></pre></div><p>安装后的路径：C:\\Users\\用户名\\.vagrant.d\\boxes</p><h3 id="添加box-带版本号" tabindex="-1">添加box(带版本号) <a class="header-anchor" href="#添加box-带版本号" aria-label="Permalink to &quot;添加box(带版本号)&quot;">​</a></h3><p>直接下载的box不带<strong>metadata</strong>，在添加box到本地时其版本号为0。然而有些情况下，我们需要指定box版本号(Vagrantfile文件中的配置项config.vm.box_version)，就需要编写metadata.json文件来添加box。</p><p>示例：</p><p><strong>直接添加box，版本号为0</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>D:\\&gt;vagrant box add generic/centos7 Generic-CentOS-7-4.0.4.virtualbox.box</span></span>
<span class="line"><span>==&gt; box: Box file was not detected as metadata. Adding it directly...</span></span>
<span class="line"><span>==&gt; box: Adding box &#39;generic/centos7&#39; (v0) for provider:</span></span>
<span class="line"><span>    box: Unpacking necessary files from: file://D:/Generic-CentOS-7-4.0.4.virtualbox.box</span></span>
<span class="line"><span>    box:</span></span>
<span class="line"><span>==&gt; box: Successfully added box &#39;generic/centos7&#39; (v0) for &#39;virtualbox&#39;!</span></span>
<span class="line"><span></span></span>
<span class="line"><span>D:\\&gt;vagrant box list</span></span>
<span class="line"><span>generic/centos7 (virtualbox, 0)</span></span></code></pre></div><p>删除添加的box</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>D:\\&gt;vagrant box remove generic/centos7</span></span>
<span class="line"><span>Removing box &#39;generic/centos7&#39; (v4.0.4) with provider &#39;virtualbox&#39;...</span></span></code></pre></div><p><strong>使用编写metadata的方式添加box</strong></p><p>创建metadata.json文件</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;generic/centos7&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;versions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;4.0.4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;providers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;virtualbox&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;file://D:/Generic-CentOS-7-4.0.4.virtualbox.box&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>再次添加box</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">D:\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> metadata.json</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">box:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Loading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> metadata</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;metadata.json&#39;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    box:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> URL:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file://D:/metadata.json</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">box:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Adding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;generic/centos7&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (v4.0.4) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> provider: virtualbox</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    box:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Unpacking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> necessary</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> files</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file://D:/Generic-CentOS-7-4.0.4.virtualbox.box</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    box:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">box:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> added</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;generic/centos7&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (v4.0.4) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;virtualbox&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">D:\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">vagrant</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> box</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">generic/centos7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (virtualbox, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.0.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h2 id="三、创建虚拟机后续设置" tabindex="-1">三、创建虚拟机后续设置 <a class="header-anchor" href="#三、创建虚拟机后续设置" aria-label="Permalink to &quot;三、创建虚拟机后续设置&quot;">​</a></h2><p>参考：<a href="https://www.cnblogs.com/rouqinglangzi/p/11370646.html" target="_blank" rel="noreferrer">使用vagrant创建虚拟机 </a></p><h2 id="四、其它" tabindex="-1">四、其它 <a class="header-anchor" href="#四、其它" aria-label="Permalink to &quot;四、其它&quot;">​</a></h2><p>vagrant+ngrok外网访问，参考：<a href="https://cloud.tencent.com/developer/article/1930824" target="_blank" rel="noreferrer">https://cloud.tencent.com/developer/article/1930824</a></p>`,41),p=[e];function l(h,r,k,o,d,g){return i(),a("div",null,p)}const E=s(t,[["render",l]]);export{F as __pageData,E as default};
